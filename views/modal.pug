extends layout.pug

include utils.pug

block content

  //- Nav Bar for user information and logout
  div(class='nav-container')

    //- Display message to user if they are logged in
    div(id='welcome__user')
      if locals.authenticated
        span=`Welcome ${user.firstName}`
        span You have the current tasks!
      else
        span Login New Beaver!
        span You have no tasks to be done!

    //- Display of how many task are done.
    div(id='current__tasks')
      a(class='nav-link active' href='#')=`${navBarTasks.inProgress} In progress`
      a(class='nav-link' href='#')=`${navBarTasks.dueToday} Due Today`
      a(class='nav-link' href='#')=`${navBarTasks.completed} Completed`

    //- If logged in display button to logout
    if locals.authenticated
      div(id='logout__button')
        form(action='/logout' method='post')
          button(type='submit') Logout

  //- Where all our project names is at
  div(class='home__display')
    div(class='project__list__div')
      div(class='project__add')
        p New project
        button(id='project__add__button')
          i(class='fa-solid fa-folder-plus')
      div(class='project__list')

        //- Example if not logged in
        if !locals.authenticated
          div(class='project__link')
            a(href="#")=`Project name Example`
        //- Actual list
        else
          each project in projects
            div(class='project__link' id=`project-id-${project.id}`)
              a(href=`/projects/${project.id}`)=`${project.projectName}`

    //- ADD PROJECT FORM
    +errorsSummary()
    form(action="/api/projects" method="POST" class="" id="addProject")
      input(type="hidden" name="_csrf" value=csrfToken)
      +form("Project Name:", "projectName", "", "text")
      +form("Description:", "description", "", "text")
      +form("Due Date:", "dueDate", "", "date")
      +form("Url:", "url", "", "text")
      label(for="projectType") Project Type:
      select(name="projectType")
        option(value="personal") Personal
        option(value="groceries") Groceries
        option(value="project") Project
        option(value="company") Company
      button(type="submit" id="confirm__Project__Button") Confirm
      button(type="click" id="cancel-add__Project__Button") Cancel


    //- EDIT PROJECT
    +errorsSummary()
    form(action="/api/projects/:id" method="PUT" class="hidden" id="editForm")
      input(type="hidden" name="_csrf" value=csrfToken)
      +form("Project Name:", "projectName", "", "text")
      +form("Description:", "description", "", "text")
      +form("Due Date:", "dueDate", "", "date")
      +form("Url:", "url", "", "text")
      label(for="projectType") Project Type:
      select(name="projectType")
        option(value="personal") Personal
        option(value="groceries") Groceries
        option(value="project") Project
        option(value="company") Company
      button(type="submit" id="edit__Project__Button") Edit
      button(type="click" id="cancel-edit__Project__Button") Cancel


    //-EDIT TASK PROJECT
    form(action="/api//tasks/:id" method="POST" class="hidden")
      input(type="hidden" name="_csrf" value=csrfToken)
      +form("Task Title:", "taskTitle", taskTitle, "text")
      +form("Description:", "description", description, "text")
      +form("Due Date:", "dueDate", dueDate, "date")
      label(for="tag") Tag Type:
      select(name="tag")
        option(value="urgent") Urgent
        option(value="important") Important
        option(value="notAtIssue") Not at Issue
        option(value="noDamGiven") NoDamGiven
      button(type="submit" id="confirm__Task__Button") Confirm
      button(type="click" id="cancel-add__Task__Button") Cancel

    //- Entire project dashboard
    div(class='project__board')

      //- Project dashboard header
      div(class='project__header')
        div(class='project__buttons')
          span
            button
              i(class='fa-solid fa-pen-to-square')
          span
            button
              i(class='fa-solid fa-trash-can')
          span
            button
              i(class='fa-solid fa-address-card')
        span=projectDisplay.projectName
        span
          input(type='text' id='search__input' class='hidden')
          button(id='search__button')
            i(class='fa-solid fa-magnifying-glass')

      //- Project dashboard main which displays tasks under a project
      //- Example task layout if not logged in
      if !locals.authenticated
        div(class="project__main")
          div(class='project__task__container')
            div(class='task__title') Task Title 1 Example
            div(class='task__tag')
              span(class="badge bg-urgent") Urgent
            div(class='project__task' class='')
              div(class='task__description') Task Description
              div(class= 'task__dueDate') date
      //- Actual task list
      else
          +errorsSummary()
          form(action="/api/tasks" method="POST" class="test__task__form")
            input(type="hidden" name="_csrf" value=csrfToken)
            +form("Task Title:", "taskTitle", taskTitle, "text")
            +form("Description:", "description", description, "text")
            +form("Due Date:", "dueDate", dueDate, "date")
            input(type='integer' name='projectId' value=`${projectDisplay.id}` class='add__task__id')
            label(for="tag") Tag Type:
            select(name="tag" class="task__select")
              option(value="urgent") Urgent
              option(value="important") Important
              option(value="notAtIssue") Not at Issue
              option(value="noDamGiven") NoDamGiven
            button(type="submit" id="confirm__Task__Button" class = 'test__task__add') Confirm
            button(type="click" id="cancel-add__Task__Button") Cancel
              div(class="project__main")
          each task in tasks
            div(class='project__task__container' id=`task-container-${task.id}`)
              div(class='task__title' id=`task-title-${task.id}`)=`${task.taskTitle}`
              div(class='task__tag')
                span(class="badge bg-urgent" id=`task-tag-${task.id}`)=task.tag
              div(class='project__task')
                div(class='task__description' id=`task-description-${task.id}`)=task.description
                if(task.dueDate)
                  div(class= 'task__dueDate' id=`task-dueDate-${task.id}`) #{task.dueDate.toLocaleDateString()}




    //- Modal popup if not signed in
    if !locals.authenticated
      div(class='modal' id='modal')
        //- DEMO BUTTON
        div(class='modal__forms')
          div(class='modal__header')
            h1 TEST
          +errorsSummary(errors)
          //- Login form
          form(action='/login' method='POST')
            input(type='hidden' name='_csrf' value=csrfToken)
            +form('Email Address','email','','email','email@email.com')
            +form('Password', 'hashedPassword', '', 'password')
            button(type='submit' class='button-class' id='Login') Login
          //- DEMO FORM
          form(action="/login" method="POST")
            input(type='hidden' name='_csrf' value=csrfToken)
            +form('','email','demo@taskbeaver.com', 'hidden')
            +form('', 'hashedPassword','Test!ing123', 'hidden')
            button(type="submit" id="demo__Login__Button") Demo User
          div
          //- Sign-up form
          div(class='modal_sign_up')
            +errorsSummary(errorArray)
            form(action="/sign-up" method="POST")
              input(type="hidden" name="_csrf" value=csrfToken)
              +form("First Name", "firstName", '', "text")
              +form("Last Name", "lastName", '', "text")
              +form("Email", "email", '', "email")
              +form("Password", "hashedPassword", '', "password")
              +form("Confirm Password", "confirmPassword", "", "password")
              div
                  button(type="submit" class="button-class" id=`Sign-up`) Become a Beaver
